import{E as p}from"./index-DQKEvUsp.js";import"./CesiumEarth-D0reHEmA.js";import{_ as h,e as g,c as y,a as m,b as w,w as c,F as D,r as u,o as _}from"./index-DQxC938F.js";class M{constructor(t,i){this.viewer=t,this.uri=i.uri,this.position=i.position,this.conf=i.conf,this.InitModel()}InitModel(){const{viewer:t}=this,{id:i,name:a,text:o,scale:e=1}=this.conf,n=Cesium.Cartesian3.fromDegrees(...this.position),r={id:i,position:n,model:{uri:this.uri,scale:e},label:{position:n,backgroundPadding:new Cesium.Cartesian2(7,7),showBackground:!0,text:o,name:a,font:"30px sans-serif",scale:.4,fillColor:Cesium.Color.WHITE,horizontalOrigin:Cesium.HorizontalOrigin.CENTER,verticalOrigin:Cesium.VerticalOrigin.CENTER,distanceDisplayCondition:new Cesium.DistanceDisplayCondition(7e5,8e6),pixelOffset:new Cesium.Cartesian2(0,-50)}};i!=="sat"&&(r.distanceDisplayCondition=new Cesium.DistanceDisplayCondition(1e3,5e5)),t.entities.add(r)}addPrimitiveLabel(t="",i){if(!t)return;this.viewer.scene.primitives.add(new Cesium.LabelCollection).add({position:Cesium.Cartesian3.fromDegrees(...i),backgroundPadding:new Cesium.Cartesian2(7,7),showBackground:!0,text:t,font:"30px sans-serif",scale:.4,fillColor:Cesium.Color.WHITE,horizontalOrigin:Cesium.HorizontalOrigin.CENTER,verticalOrigin:Cesium.VerticalOrigin.CENTER,distanceDisplayCondition:new Cesium.DistanceDisplayCondition(1e3,5e5),eyeOffset:Cesium.Cartesian3(1e3,0,0),pixelOffset:new Cesium.Cartesian2(0,-50)})}addPrimitiveLine(t){const i=new Cesium.Primitive({geometryInstances:new Cesium.GeometryInstance({geometry:new Cesium.PolylineGeometry({positions:Cesium.Cartesian3.fromDegreesArrayHeights([...this.position,...t]),width:2})}),appearance:new Cesium.PolylineMaterialAppearance({material:Cesium.Material.fromType(Cesium.Material.PolylineDashType,{color:Cesium.Color.YELLOW,gapColor:Cesium.Color.TRANSPARENT,dashLength:5})})});this.viewer.scene.primitives.add(i)}}const P=(s,t,i,a)=>{new M(s,{uri:"/src/assets/model/radar_dynamic.glb",position:a,conf:{id:t,name:i,text:i,pixelOffset:new Cesium.Cartesian2(0,50),scale:100}})};function x(s,t,i,a){const o=Cesium.Transforms.eastNorthUpToFixedFrame(Cesium.Cartesian3.fromDegrees(s,t)),e=i*Math.cos(a*Math.PI/180),n=i*Math.sin(a*Math.PI/180),r=Cesium.Cartesian3.fromElements(e,n,0),l=Cesium.Matrix4.multiplyByPoint(o,r,new Cesium.Cartesian3),C=Cesium.Cartographic.fromCartesian(l),d=Cesium.Math.toDegrees(C.longitude),f=Cesium.Math.toDegrees(C.latitude);return Cesium.Cartesian3.fromDegrees(d,f,365e3)}function E(s,t){const i=Cesium.Transforms.eastNorthUpToFixedFrame(s),a=Cesium.Cartesian3.subtract(t,s,new Cesium.Cartesian3),o=Cesium.Matrix4.multiplyByPointAsVector(Cesium.Matrix4.inverse(i,new Cesium.Matrix4),a,new Cesium.Cartesian3),e=Cesium.Cartesian3.normalize(o,new Cesium.Cartesian3),n=Math.atan2(e.y,e.x)-Cesium.Math.PI_OVER_TWO;return Cesium.Math.TWO_PI-Cesium.Math.zeroToTwoPi(n)}const T=(s,t)=>{let i=108.1,a=34.85,o=365e3;if(!t){s.entities.removeById("radarD1"),s.entities.removeById("radarScanD1"),s.entities.removeById("yuanzhu");return}let e=192,n=Cesium.Cartesian3.fromDegrees(108,34,o);s.entities.add({id:"radarScanD1",name:"radarScanD1",position:new Cesium.CallbackProperty(()=>n,!1),cylinder:{length:8e5,topRadius:5e4,bottomRadius:2e5,material:new Cesium.ImageMaterialProperty({color:Cesium.Color.RED.withAlpha(.3),transparent:!0})},orientation:new Cesium.CallbackProperty(()=>Cesium.Transforms.headingPitchRollQuaternion(Cesium.Cartesian3.fromDegrees(108,34,0),new Cesium.HeadingPitchRoll(E(Cesium.Cartesian3.fromDegrees(108,34,0),n),Cesium.Math.toRadians(0),Cesium.Math.toRadians(120))),!1)}),s.entities.add({id:"yuanzhu",position:Cesium.Cartesian3.fromDegrees(108,34,5e4),cylinder:{length:15e3,topRadius:4e3,bottomRadius:4e3,material:Cesium.Color.GREEN.withAlpha(.4)}}),P(s,"radarD1","",[i,a,0]),s.clock.onTick.addEventListener(()=>{e<192&&(e+=.05),e<200&&e>=192&&(e+=.08),e<210&&e>=200&&(e+=.05),e>=210&&e<315&&(e+=.15),e>=315&&e<360&&(e+=.25),e>=0&&e<110&&(e+=.2),e>=110&&e<192&&(e+=.06),e>360&&(e=0),n=x(108,34,4e5,e)})},R={class:"toolPane"},v={__name:"index",setup(s){const t=g(!1),i=()=>{T(viewer,!0)};return(a,o)=>{const e=u("el-switch"),n=u("el-form-item"),r=u("el-form");return _(),y(D,null,[m(p),w("div",R,[m(r,{"label-width":"auto",inline:!0},{default:c(()=>[m(n,{label:"雷达追踪"},{default:c(()=>[m(e,{modelValue:t.value,"onUpdate:modelValue":o[0]||(o[0]=l=>t.value=l),onChange:i},null,8,["modelValue"])]),_:1})]),_:1})])],64)}}},k=h(v,[["__scopeId","data-v-ffa7dd29"]]);export{k as default};
