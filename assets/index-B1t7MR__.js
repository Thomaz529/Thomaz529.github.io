import{E as d}from"./index-hnr1oFTy.js";import{v as m}from"./CesiumEarth-DSJv-lZu.js";import{_ as u,c as f,a as c,b as p,w as y,F as C,r as _,o as v,d as w,p as b,e as x}from"./index-Do2SFHFE.js";class E{constructor(e,t){this.init(t),this._option=t,this._viewer=e,this.echartsdom=null,this.point=[],this.polyline=[],this.myChart=null,this.start=null,this.end=null,this.count=t.count}init(e){this.createchartsdom(e.dom)}delete(){let e=this;e.echartsdom.parentNode.removeChild(e.echartsdom),e.point.forEach(t=>{e._viewer.entities.remove(t)}),e.polyline.forEach(t=>{e._viewer.entities.remove(t)}),e.point=[],e.polyline=[],e.start=null,e.end=null,this.myChart=null}createchartsdom(e){let t=this;const i=document.createElement("div");i.style="width: 600px;height:400px;display: none;z-index: 1; position: absolute; top: 80px; left: 250px; ",e.appendChild(i),setTimeout(()=>{t.echartsdom=i},1e3)}drawPoint(e){let t=this;var i=t._viewer.entities.add({position:e,point:{size:20,color:Cesium.Color.GREEN}});t.point.push(i)}drawLine(){let e=this;var t=e._viewer.entities.add({polyline:{positions:new Cesium.CallbackProperty(function(){return[e.start,e.end]},!1),material:Cesium.Color.RED,width:10,clampToGround:!0,classificationType:Cesium.ClassificationType.BOTH}});e.polyline.push(t)}beginDraw(){let e=this;e.echartsdom&&e.delete(),e.init(e._option),e._viewer.screenSpaceEventHandler.setInputAction(function(t){e.start==null?(e.start=e._viewer.scene.pickPosition(t.position),e.drawPoint(e.start),e._viewer.screenSpaceEventHandler.setInputAction(function(i){e.end=e._viewer.scene.pickPosition(i.endPosition),e.drawLine()},Cesium.ScreenSpaceEventType.MOUSE_MOVE)):(e.end=e._viewer.scene.pickPosition(t.position),e.drawPoint(e.end),e._viewer.screenSpaceEventHandler.removeInputAction(Cesium.ScreenSpaceEventType.LEFT_CLICK),e._viewer.screenSpaceEventHandler.removeInputAction(Cesium.ScreenSpaceEventType.MOUSE_MOVE),e.profileAnalyse())},Cesium.ScreenSpaceEventType.LEFT_CLICK)}profileAnalyse(){for(var e=[Cesium.Cartographic.fromCartesian(this.start)],t=this.count,i=1;i<t;i++){var n=Cesium.Cartesian3.lerp(this.start,this.end,i/t,new Cesium.Cartesian3);e.push(Cesium.Cartographic.fromCartesian(n))}e.push(Cesium.Cartographic.fromCartesian(this.end)),this.positions=e;var h=Cesium.sampleTerrainMostDetailed(this._viewer.terrainProvider,e);let o=this;h.then(function(l){for(var a=[],r=0;r<l.length;r++)a.push(l[r].height);o.height=a,o.echartsdom.style.display="block",o.myChart==null?(o.myChart=m(o.echartsdom),o.initChart(a,!1)):o.initChart(a,!0)})}initChart(e,t){const i={backgroundColor:"#000",title:{text:"剖面分析",textStyle:{align:"center",color:"#fff",fontSize:20},left:"center"},tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},toolbox:{feature:{saveAsImage:{}}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1}],yAxis:[{type:"value",axisLabel:{margin:20,textStyle:{color:"#fff"}}}],series:[{name:"海拔(m)",data:e,type:"line",symbol:"circle",symbolSize:0,color:"#FEC201",lineStyle:{normal:{width:4,shadowColor:"rgba(155, 18, 184, .5)",shadowBlur:10,shadowOffsetY:20,shadowOffsetX:20,color:"#329dd3"}},label:{show:!1}},{type:"bar",animation:!1,barWidth:3,hoverAnimation:!1,data:e,tooltip:{show:!1},itemStyle:{normal:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"#329dd3"},{offset:.8,color:"#000"}],globalCoord:!1},label:{show:!1}}}}]};this.myChart.setOption(i,t)}}const S=s=>(b("data-v-6c7f0600"),s=s(),x(),s),g=S(()=>p("canvas",{id:"visualCanvas",style:{display:"none"}},null,-1)),A={class:"toolButton"},T={__name:"index",setup(s){const e=()=>{const t=document.getElementById("cesiumContainer");new E(viewer,{dom:t,count:100}).beginDraw()};return(t,i)=>{const n=_("el-button");return v(),f(C,null,[c(d),g,p("div",A,[c(n,{type:"primary",onClick:e},{default:y(()=>[w("剖面分析")]),_:1})])],64)}}},L=u(T,[["__scopeId","data-v-6c7f0600"]]);export{L as default};
